{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { ref, onMounted } from 'vue';\nimport AddressModal from '@/components/AddressModal.vue';\nimport { ElMessage } from 'element-plus';\nimport { getAddress, saveAddress as apiSave, delAddress as apiDel, setDefault as apiSet } from '@/api/address';\n\n// 从localStorage获取用户ID（假设登录时已存储）\n//console.log(localStorage.getItem('userId'))\n//const userId = localStorage.getItem('userId') || ''\n\n// 地址列表\n\nexport default /*@__PURE__*/Object.assign({\n  name: 'UserProfile'\n}, {\n  __name: 'UserProfile',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const tabs = [{\n      key: 'profile',\n      label: '个人信息'\n    }, {\n      key: 'address',\n      label: '收货地址'\n    }, {\n      key: 'privacy',\n      label: '隐私内容'\n    }];\n    const activeTab = ref('address'); // 默认显示收货地址\n    const addressList = ref([]);\n    const defaultAddress = ref(null);\n    const showModal = ref(false);\n    const editingAddress = ref(null);\n\n    // 拉取地址\n    async function loadAddress() {\n      try {\n        const list = await getAddress();\n        addressList.value = list;\n        defaultAddress.value = list.find(i => i.isDefault) || null;\n      } catch {\n        ElMessage.error('加载地址失败');\n      }\n    }\n\n    // 设为默认\n    async function setDefault(id) {\n      try {\n        await apiSet(id);\n        ElMessage.success('已设为默认');\n        loadAddress();\n      } catch {\n        ElMessage.error('设置失败');\n      }\n    }\n\n    // 删除\n    async function delAddress(id) {\n      try {\n        await apiDel(id);\n        ElMessage.success('已删除');\n        loadAddress();\n      } catch {\n        ElMessage.error('删除失败');\n      }\n    }\n\n    // 打开新建\n    function openAdd() {\n      editingAddress.value = {\n        userId\n      };\n      showModal.value = true;\n    }\n\n    // 保存（新增或更新）\n    async function saveAddress(form) {\n      try {\n        if (!form.userId) {\n          form.userId = userId;\n        }\n        await apiSave(form);\n        ElMessage.success('保存成功');\n        showModal.value = false;\n        loadAddress();\n      } catch {\n        ElMessage.error('保存失败');\n      }\n    }\n    onMounted(loadAddress);\n    const __returned__ = {\n      tabs,\n      activeTab,\n      addressList,\n      defaultAddress,\n      showModal,\n      editingAddress,\n      loadAddress,\n      setDefault,\n      delAddress,\n      openAdd,\n      saveAddress,\n      ref,\n      onMounted,\n      AddressModal,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get getAddress() {\n        return getAddress;\n      },\n      get apiSave() {\n        return apiSave;\n      },\n      get apiDel() {\n        return apiDel;\n      },\n      get apiSet() {\n        return apiSet;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n});","map":{"version":3,"names":["ref","onMounted","AddressModal","ElMessage","getAddress","saveAddress","apiSave","delAddress","apiDel","setDefault","apiSet","tabs","key","label","activeTab","addressList","defaultAddress","showModal","editingAddress","loadAddress","list","value","find","i","isDefault","error","id","success","openAdd","userId","form"],"sources":["D:/Desktop/ecomplat/src/views/UserProfile.vue"],"sourcesContent":["<template>\r\n  <div class=\"profile-wrap\">\r\n    <!-- 顶部栏 -->\r\n    <header class=\"header\">\r\n      <span @click=\"$router.back()\" class=\"back\">← 返回首页</span>\r\n      <h2>个人中心</h2>\r\n    </header>\r\n\r\n    <!-- 新增：导航栏 -->\r\n    <nav class=\"nav-tabs\">\r\n      <span\r\n        v-for=\"tab in tabs\"\r\n        :key=\"tab.key\"\r\n        :class=\"['tab', { active: activeTab === tab.key }]\"\r\n        @click=\"activeTab = tab.key\"\r\n      >\r\n        {{ tab.label }}\r\n      </span>\r\n    </nav>\r\n\r\n    <!-- 收货地址（原来整块内容） -->\r\n    <section v-if=\"activeTab === 'address'\" class=\"address-section\">\r\n      <!-- 当前默认地址提示 -->\r\n      <section class=\"default-tip\">\r\n        当前默认地址：{{ defaultAddress?.name || '暂无' }}\r\n      </section>\r\n\r\n      <!-- 地址列表 -->\r\n      <ul class=\"address-list\">\r\n        <li v-for=\"addr in addressList\" :key=\"addr.id\" class=\"address-card\">\r\n          <div class=\"info\">\r\n            <p><strong>{{ addr.receiver }}</strong> {{ addr.phone }}</p>\r\n            <p>{{ addr.detail }}</p>\r\n            <p class=\"tag\">{{ addr.name }}</p>\r\n          </div>\r\n          <div class=\"actions\">\r\n            <button class=\"default-btn\" @click=\"setDefault(addr.id)\">\r\n              {{ addr.isDefault ? '已默认' : '设为默认' }}\r\n            </button>\r\n            <button class=\"del-btn\" @click=\"delAddress(addr.id)\">删除</button>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n\r\n      <!-- 新建 / 编辑弹窗 -->\r\n      <AddressModal\r\n        v-if=\"showModal\"\r\n        :editing=\"editingAddress\"\r\n        @close=\"showModal=false\"\r\n        @save=\"saveAddress\"\r\n      />\r\n\r\n      <!-- 底部按钮 -->\r\n      <footer class=\"add-footer\">\r\n        <button class=\"add-btn\" @click=\"openAdd\">新建地址</button>\r\n      </footer>\r\n    </section>\r\n\r\n    <!-- 预留：个人信息、隐私内容占位 -->\r\n    <section v-if=\"activeTab === 'profile'\" class=\"placeholder\">\r\n      <p>个人信息模块待开发</p>\r\n    </section>\r\n    <section v-if=\"activeTab === 'privacy'\" class=\"placeholder\">\r\n      <p>隐私内容模块待开发</p>\r\n    </section>\r\n  </div>\r\n</template>\r\n  \r\n  <script setup>\r\n  import { ref, onMounted } from 'vue'\r\n  import AddressModal from '@/components/AddressModal.vue'\r\n  import { ElMessage } from 'element-plus'\r\n  defineOptions({ name: 'UserProfile' })\r\n  import {\r\n  getAddress,\r\n  saveAddress as apiSave,\r\n  delAddress as apiDel,\r\n  setDefault as apiSet\r\n} from '@/api/address'\r\n\r\n  // 从localStorage获取用户ID（假设登录时已存储）\r\n  //console.log(localStorage.getItem('userId'))\r\n  //const userId = localStorage.getItem('userId') || ''\r\n\r\n  // 地址列表\r\n  const tabs = [\r\n  { key: 'profile', label: '个人信息' },\r\n  { key: 'address', label: '收货地址' },\r\n  { key: 'privacy', label: '隐私内容' }\r\n]\r\n  const activeTab = ref('address')   // 默认显示收货地址\r\n  const addressList = ref([])\r\n  const defaultAddress = ref(null)\r\n  const showModal = ref(false)\r\n  const editingAddress = ref(null)\r\n  \r\n  // 拉取地址\r\n  async function loadAddress () {\r\n  try {\r\n    const list = await getAddress()\r\n    addressList.value = list\r\n    defaultAddress.value = list.find(i => i.isDefault) || null\r\n  } catch {\r\n    ElMessage.error('加载地址失败')\r\n  }\r\n}\r\n  \r\n  // 设为默认\r\n  async function setDefault (id) {\r\n  try {\r\n    await apiSet(id)\r\n    ElMessage.success('已设为默认')\r\n    loadAddress()\r\n  } catch {\r\n    ElMessage.error('设置失败')\r\n  }\r\n}\r\n  \r\n  // 删除\r\n  async function delAddress (id) {\r\n  try {\r\n    await apiDel(id)\r\n    ElMessage.success('已删除')\r\n    loadAddress()\r\n  } catch {\r\n    ElMessage.error('删除失败')\r\n  }\r\n}\r\n  \r\n  // 打开新建\r\n  function openAdd () {\r\n    editingAddress.value = { userId }\r\n    showModal.value = true\r\n  }\r\n  \r\n  // 保存（新增或更新）\r\n  async function saveAddress (form) {\r\n  try {\r\n    if (!form.userId) {\r\n      form.userId = userId\r\n    }\r\n    await apiSave(form)\r\n    ElMessage.success('保存成功')\r\n    showModal.value = false\r\n    loadAddress()\r\n  } catch {\r\n    ElMessage.error('保存失败')\r\n  }\r\n}\r\n  \r\n  onMounted(loadAddress)\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .nav-tabs {\r\n  display: flex;\r\n  background: #fff;\r\n  border-bottom: 1px solid #eee;\r\n}\r\n.tab {\r\n  flex: 1;\r\n  text-align: center;\r\n  padding: 12px 0;\r\n  font-size: 15px;\r\n  color: #333;\r\n  cursor: pointer;\r\n}\r\n.tab.active {\r\n  color: #1890ff;\r\n  font-weight: bold;\r\n  border-bottom: 2px solid #1890ff;\r\n}\r\n.placeholder {\r\n  text-align: center;\r\n  padding: 50px 0;\r\n  color: #999;\r\n}\r\n  .profile-wrap { min-height: 100vh; background: #f6f6f6; }\r\n  .header {\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 12px;\r\n    background: #fff;\r\n    border-bottom: 1px solid #eee;\r\n  }\r\n  .back { margin-right: 12px; font-size: 16px; color: #1890ff; cursor: pointer; }\r\n  .default-tip { padding: 10px 15px; font-size: 14px; color: #666; }\r\n  .address-list { padding: 0 15px 70px; }\r\n  .address-card {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    background: #fff;\r\n    margin-bottom: 10px;\r\n    padding: 12px;\r\n    border-radius: 6px;\r\n  }\r\n  .address-card .info p { margin: 4px 0; font-size: 14px; }\r\n  .actions button {\r\n    margin-left: 8px;\r\n    padding: 4px 8px;\r\n    border: none;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    cursor: pointer;\r\n  }\r\n  .default-btn { background: #1890ff; color: #fff; }\r\n  .del-btn { background: #ff4d4f; color: #fff; }\r\n  .add-footer {\r\n    position: fixed;\r\n    bottom: 0;\r\n    width: 100%;\r\n    padding: 10px;\r\n    background: #fff;\r\n  }\r\n  .add-btn {\r\n    width: 100%;\r\n    padding: 12px;\r\n    border: none;\r\n    border-radius: 4px;\r\n    background: #ff5000;\r\n    color: #fff;\r\n    font-size: 16px;\r\n    cursor: pointer;\r\n  }\r\n  </style>"],"mappings":";;AAqEE,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,YAAY,MAAM,+BAA+B;AACxD,SAASC,SAAS,QAAQ,cAAc;AAExC,SACAC,UAAU,EACVC,WAAW,IAAIC,OAAO,EACtBC,UAAU,IAAIC,MAAM,EACpBC,UAAU,IAAIC,MAAM,QACf,eAAe;;AAEpB;AACA;AACA;;AAEA;;;;;;;;;;IACA,MAAMC,IAAI,GAAG,CACb;MAAEC,GAAG,EAAE,SAAS;MAAEC,KAAK,EAAE;IAAO,CAAC,EACjC;MAAED,GAAG,EAAE,SAAS;MAAEC,KAAK,EAAE;IAAO,CAAC,EACjC;MAAED,GAAG,EAAE,SAAS;MAAEC,KAAK,EAAE;IAAO,CAAC,CAClC;IACC,MAAMC,SAAS,GAAGd,GAAG,CAAC,SAAS,CAAC,EAAG;IACnC,MAAMe,WAAW,GAAGf,GAAG,CAAC,EAAE,CAAC;IAC3B,MAAMgB,cAAc,GAAGhB,GAAG,CAAC,IAAI,CAAC;IAChC,MAAMiB,SAAS,GAAGjB,GAAG,CAAC,KAAK,CAAC;IAC5B,MAAMkB,cAAc,GAAGlB,GAAG,CAAC,IAAI,CAAC;;IAEhC;IACA,eAAemB,WAAWA,CAAA,EAAI;MAC9B,IAAI;QACF,MAAMC,IAAI,GAAG,MAAMhB,UAAU,CAAC,CAAC;QAC/BW,WAAW,CAACM,KAAK,GAAGD,IAAI;QACxBJ,cAAc,CAACK,KAAK,GAAGD,IAAI,CAACE,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,SAAS,CAAC,IAAI,IAAI;MAC5D,CAAC,CAAC,MAAM;QACNrB,SAAS,CAACsB,KAAK,CAAC,QAAQ,CAAC;MAC3B;IACF;;IAEE;IACA,eAAehB,UAAUA,CAAEiB,EAAE,EAAE;MAC/B,IAAI;QACF,MAAMhB,MAAM,CAACgB,EAAE,CAAC;QAChBvB,SAAS,CAACwB,OAAO,CAAC,OAAO,CAAC;QAC1BR,WAAW,CAAC,CAAC;MACf,CAAC,CAAC,MAAM;QACNhB,SAAS,CAACsB,KAAK,CAAC,MAAM,CAAC;MACzB;IACF;;IAEE;IACA,eAAelB,UAAUA,CAAEmB,EAAE,EAAE;MAC/B,IAAI;QACF,MAAMlB,MAAM,CAACkB,EAAE,CAAC;QAChBvB,SAAS,CAACwB,OAAO,CAAC,KAAK,CAAC;QACxBR,WAAW,CAAC,CAAC;MACf,CAAC,CAAC,MAAM;QACNhB,SAAS,CAACsB,KAAK,CAAC,MAAM,CAAC;MACzB;IACF;;IAEE;IACA,SAASG,OAAOA,CAAA,EAAI;MAClBV,cAAc,CAACG,KAAK,GAAG;QAAEQ;MAAO,CAAC;MACjCZ,SAAS,CAACI,KAAK,GAAG,IAAI;IACxB;;IAEA;IACA,eAAehB,WAAWA,CAAEyB,IAAI,EAAE;MAClC,IAAI;QACF,IAAI,CAACA,IAAI,CAACD,MAAM,EAAE;UAChBC,IAAI,CAACD,MAAM,GAAGA,MAAM;QACtB;QACA,MAAMvB,OAAO,CAACwB,IAAI,CAAC;QACnB3B,SAAS,CAACwB,OAAO,CAAC,MAAM,CAAC;QACzBV,SAAS,CAACI,KAAK,GAAG,KAAK;QACvBF,WAAW,CAAC,CAAC;MACf,CAAC,CAAC,MAAM;QACNhB,SAAS,CAACsB,KAAK,CAAC,MAAM,CAAC;MACzB;IACF;IAEExB,SAAS,CAACkB,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}