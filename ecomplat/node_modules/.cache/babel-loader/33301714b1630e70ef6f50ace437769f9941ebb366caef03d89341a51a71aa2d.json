{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { ref, onMounted } from 'vue';\nimport AddressModal from '@/components/AddressModal.vue';\nimport { ElMessage } from 'element-plus';\nexport default /*@__PURE__*/Object.assign({\n  name: 'UserProfile'\n}, {\n  __name: 'UserProfile',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const tabs = [{\n      key: 'profile',\n      label: '个人信息'\n    }, {\n      key: 'address',\n      label: '收货地址'\n    }, {\n      key: 'privacy',\n      label: '隐私内容'\n    }];\n    const activeTab = ref('address'); // 默认显示收货地址\n    const addressList = ref([]);\n    const defaultAddress = ref(null);\n    const showModal = ref(false);\n    const editingAddress = ref(null);\n\n    // 拉取地址\n    async function loadAddress() {\n      try {\n        const res = await fetch('http://localhost:8081/api/address', {\n          credentials: 'include'\n        });\n        const list = await res.json();\n        addressList.value = list;\n        defaultAddress.value = list.find(i => i.isDefault) || null;\n      } catch (e) {\n        ElMessage.error('加载地址失败');\n      }\n    }\n\n    // 设为默认\n    async function setDefault(id) {\n      await fetch(`http://localhost:8081/api/address/default/${id}`, {\n        method: 'POST',\n        credentials: 'include'\n      });\n      ElMessage.success('已设为默认');\n      loadAddress();\n    }\n\n    // 删除\n    async function delAddress(id) {\n      await fetch(`http://localhost:8081/api/address/${id}`, {\n        method: 'DELETE',\n        credentials: 'include'\n      });\n      ElMessage.success('已删除');\n      loadAddress();\n    }\n\n    // 打开新建\n    function openAdd() {\n      editingAddress.value = null;\n      showModal.value = true;\n    }\n\n    // 保存（新增或更新）\n    async function saveAddress(form) {\n      const method = form.id ? 'PUT' : 'POST';\n      await fetch('http://localhost:8081/api/address', {\n        method,\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: 'include',\n        body: JSON.stringify(form)\n      });\n      ElMessage.success('保存成功');\n      showModal.value = false;\n      loadAddress();\n    }\n    onMounted(loadAddress);\n    const __returned__ = {\n      tabs,\n      activeTab,\n      addressList,\n      defaultAddress,\n      showModal,\n      editingAddress,\n      loadAddress,\n      setDefault,\n      delAddress,\n      openAdd,\n      saveAddress,\n      ref,\n      onMounted,\n      AddressModal,\n      get ElMessage() {\n        return ElMessage;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n});","map":{"version":3,"names":["ref","onMounted","AddressModal","ElMessage","tabs","key","label","activeTab","addressList","defaultAddress","showModal","editingAddress","loadAddress","res","fetch","credentials","list","json","value","find","i","isDefault","e","error","setDefault","id","method","success","delAddress","openAdd","saveAddress","form","headers","body","JSON","stringify"],"sources":["D:/Desktop/ecomplat/src/views/UserProfile.vue"],"sourcesContent":["<template>\r\n  <div class=\"profile-wrap\">\r\n    <!-- 顶部栏 -->\r\n    <header class=\"header\">\r\n      <span @click=\"$router.back()\" class=\"back\">← 返回首页</span>\r\n      <h2>个人中心</h2>\r\n    </header>\r\n\r\n    <!-- 新增：导航栏 -->\r\n    <nav class=\"nav-tabs\">\r\n      <span\r\n        v-for=\"tab in tabs\"\r\n        :key=\"tab.key\"\r\n        :class=\"['tab', { active: activeTab === tab.key }]\"\r\n        @click=\"activeTab = tab.key\"\r\n      >\r\n        {{ tab.label }}\r\n      </span>\r\n    </nav>\r\n\r\n    <!-- 收货地址（原来整块内容） -->\r\n    <section v-if=\"activeTab === 'address'\" class=\"address-section\">\r\n      <!-- 当前默认地址提示 -->\r\n      <section class=\"default-tip\">\r\n        当前默认地址：{{ defaultAddress?.name || '暂无' }}\r\n      </section>\r\n\r\n      <!-- 地址列表 -->\r\n      <ul class=\"address-list\">\r\n        <li v-for=\"addr in addressList\" :key=\"addr.id\" class=\"address-card\">\r\n          <div class=\"info\">\r\n            <p><strong>{{ addr.receiver }}</strong> {{ addr.phone }}</p>\r\n            <p>{{ addr.detail }}</p>\r\n            <p class=\"tag\">{{ addr.name }}</p>\r\n          </div>\r\n          <div class=\"actions\">\r\n            <button class=\"default-btn\" @click=\"setDefault(addr.id)\">\r\n              {{ addr.isDefault ? '已默认' : '设为默认' }}\r\n            </button>\r\n            <button class=\"del-btn\" @click=\"delAddress(addr.id)\">删除</button>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n\r\n      <!-- 新建 / 编辑弹窗 -->\r\n      <AddressModal\r\n        v-if=\"showModal\"\r\n        :editing=\"editingAddress\"\r\n        @close=\"showModal=false\"\r\n        @save=\"saveAddress\"\r\n      />\r\n\r\n      <!-- 底部按钮 -->\r\n      <footer class=\"add-footer\">\r\n        <button class=\"add-btn\" @click=\"openAdd\">新建地址</button>\r\n      </footer>\r\n    </section>\r\n\r\n    <!-- 预留：个人信息、隐私内容占位 -->\r\n    <section v-if=\"activeTab === 'profile'\" class=\"placeholder\">\r\n      <p>个人信息模块待开发</p>\r\n    </section>\r\n    <section v-if=\"activeTab === 'privacy'\" class=\"placeholder\">\r\n      <p>隐私内容模块待开发</p>\r\n    </section>\r\n  </div>\r\n</template>\r\n  \r\n  <script setup>\r\n  import { ref, onMounted } from 'vue'\r\n  import AddressModal from '@/components/AddressModal.vue'\r\n  import { ElMessage } from 'element-plus'\r\n  defineOptions({ name: 'UserProfile' })\r\n  \r\n  const tabs = [\r\n  { key: 'profile', label: '个人信息' },\r\n  { key: 'address', label: '收货地址' },\r\n  { key: 'privacy', label: '隐私内容' }\r\n]\r\n  const activeTab = ref('address')   // 默认显示收货地址\r\n  const addressList = ref([])\r\n  const defaultAddress = ref(null)\r\n  const showModal = ref(false)\r\n  const editingAddress = ref(null)\r\n  \r\n  // 拉取地址\r\n  async function loadAddress () {\r\n    try {\r\n      const res = await fetch('http://localhost:8081/api/address', { credentials: 'include' })\r\n      const list = await res.json()\r\n      addressList.value = list\r\n      defaultAddress.value = list.find(i => i.isDefault) || null\r\n    } catch (e) {\r\n      ElMessage.error('加载地址失败')\r\n    }\r\n  }\r\n  \r\n  // 设为默认\r\n  async function setDefault (id) {\r\n    await fetch(`http://localhost:8081/api/address/default/${id}`, { method: 'POST', credentials: 'include' })\r\n    ElMessage.success('已设为默认')\r\n    loadAddress()\r\n  }\r\n  \r\n  // 删除\r\n  async function delAddress (id) {\r\n    await fetch(`http://localhost:8081/api/address/${id}`, { method: 'DELETE', credentials: 'include' })\r\n    ElMessage.success('已删除')\r\n    loadAddress()\r\n  }\r\n  \r\n  // 打开新建\r\n  function openAdd () {\r\n    editingAddress.value = null\r\n    showModal.value = true\r\n  }\r\n  \r\n  // 保存（新增或更新）\r\n  async function saveAddress (form) {\r\n    const method = form.id ? 'PUT' : 'POST'\r\n    await fetch('http://localhost:8081/api/address', {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      credentials: 'include',\r\n      body: JSON.stringify(form)\r\n    })\r\n    ElMessage.success('保存成功')\r\n    showModal.value = false\r\n    loadAddress()\r\n  }\r\n  \r\n  onMounted(loadAddress)\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .profile-wrap { min-height: 100vh; background: #f6f6f6; }\r\n  .header {\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 12px;\r\n    background: #fff;\r\n    border-bottom: 1px solid #eee;\r\n  }\r\n  .back { margin-right: 12px; font-size: 16px; color: #1890ff; cursor: pointer; }\r\n  .default-tip { padding: 10px 15px; font-size: 14px; color: #666; }\r\n  .address-list { padding: 0 15px 70px; }\r\n  .address-card {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    background: #fff;\r\n    margin-bottom: 10px;\r\n    padding: 12px;\r\n    border-radius: 6px;\r\n  }\r\n  .address-card .info p { margin: 4px 0; font-size: 14px; }\r\n  .actions button {\r\n    margin-left: 8px;\r\n    padding: 4px 8px;\r\n    border: none;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    cursor: pointer;\r\n  }\r\n  .default-btn { background: #1890ff; color: #fff; }\r\n  .del-btn { background: #ff4d4f; color: #fff; }\r\n  .add-footer {\r\n    position: fixed;\r\n    bottom: 0;\r\n    width: 100%;\r\n    padding: 10px;\r\n    background: #fff;\r\n  }\r\n  .add-btn {\r\n    width: 100%;\r\n    padding: 12px;\r\n    border: none;\r\n    border-radius: 4px;\r\n    background: #ff5000;\r\n    color: #fff;\r\n    font-size: 16px;\r\n    cursor: pointer;\r\n  }\r\n  </style>"],"mappings":";;AAqEE,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,OAAOC,YAAY,MAAM,+BAA+B;AACxD,SAASC,SAAS,QAAQ,cAAc;;;;;;;;;IAGxC,MAAMC,IAAI,GAAG,CACb;MAAEC,GAAG,EAAE,SAAS;MAAEC,KAAK,EAAE;IAAO,CAAC,EACjC;MAAED,GAAG,EAAE,SAAS;MAAEC,KAAK,EAAE;IAAO,CAAC,EACjC;MAAED,GAAG,EAAE,SAAS;MAAEC,KAAK,EAAE;IAAO,CAAC,CAClC;IACC,MAAMC,SAAS,GAAGP,GAAG,CAAC,SAAS,CAAC,EAAG;IACnC,MAAMQ,WAAW,GAAGR,GAAG,CAAC,EAAE,CAAC;IAC3B,MAAMS,cAAc,GAAGT,GAAG,CAAC,IAAI,CAAC;IAChC,MAAMU,SAAS,GAAGV,GAAG,CAAC,KAAK,CAAC;IAC5B,MAAMW,cAAc,GAAGX,GAAG,CAAC,IAAI,CAAC;;IAEhC;IACA,eAAeY,WAAWA,CAAA,EAAI;MAC5B,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,mCAAmC,EAAE;UAAEC,WAAW,EAAE;QAAU,CAAC,CAAC;QACxF,MAAMC,IAAI,GAAG,MAAMH,GAAG,CAACI,IAAI,CAAC,CAAC;QAC7BT,WAAW,CAACU,KAAK,GAAGF,IAAI;QACxBP,cAAc,CAACS,KAAK,GAAGF,IAAI,CAACG,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,SAAS,CAAC,IAAI,IAAI;MAC5D,CAAC,CAAC,OAAOC,CAAC,EAAE;QACVnB,SAAS,CAACoB,KAAK,CAAC,QAAQ,CAAC;MAC3B;IACF;;IAEA;IACA,eAAeC,UAAUA,CAAEC,EAAE,EAAE;MAC7B,MAAMX,KAAK,CAAC,6CAA6CW,EAAE,EAAE,EAAE;QAAEC,MAAM,EAAE,MAAM;QAAEX,WAAW,EAAE;MAAU,CAAC,CAAC;MAC1GZ,SAAS,CAACwB,OAAO,CAAC,OAAO,CAAC;MAC1Bf,WAAW,CAAC,CAAC;IACf;;IAEA;IACA,eAAegB,UAAUA,CAAEH,EAAE,EAAE;MAC7B,MAAMX,KAAK,CAAC,qCAAqCW,EAAE,EAAE,EAAE;QAAEC,MAAM,EAAE,QAAQ;QAAEX,WAAW,EAAE;MAAU,CAAC,CAAC;MACpGZ,SAAS,CAACwB,OAAO,CAAC,KAAK,CAAC;MACxBf,WAAW,CAAC,CAAC;IACf;;IAEA;IACA,SAASiB,OAAOA,CAAA,EAAI;MAClBlB,cAAc,CAACO,KAAK,GAAG,IAAI;MAC3BR,SAAS,CAACQ,KAAK,GAAG,IAAI;IACxB;;IAEA;IACA,eAAeY,WAAWA,CAAEC,IAAI,EAAE;MAChC,MAAML,MAAM,GAAGK,IAAI,CAACN,EAAE,GAAG,KAAK,GAAG,MAAM;MACvC,MAAMX,KAAK,CAAC,mCAAmC,EAAE;QAC/CY,MAAM;QACNM,OAAO,EAAE;UAAE,cAAc,EAAE;QAAmB,CAAC;QAC/CjB,WAAW,EAAE,SAAS;QACtBkB,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,IAAI;MAC3B,CAAC,CAAC;MACF5B,SAAS,CAACwB,OAAO,CAAC,MAAM,CAAC;MACzBjB,SAAS,CAACQ,KAAK,GAAG,KAAK;MACvBN,WAAW,CAAC,CAAC;IACf;IAEAX,SAAS,CAACW,WAAW,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}