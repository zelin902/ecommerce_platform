{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"ecommerce-home\"\n};\nconst _hoisted_2 = {\n  class: \"user-actions\"\n};\nconst _hoisted_3 = {\n  class: \"search-container\"\n};\nconst _hoisted_4 = {\n  class: \"search-bar\"\n};\nconst _hoisted_5 = {\n  class: \"main-nav\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"dropdown-menu\"\n};\nconst _hoisted_7 = {\n  key: 0,\n  class: \"cart-badge\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ProductList = _resolveComponent(\"ProductList\");\n  const _component_AuthModal = _resolveComponent(\"AuthModal\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 顶部用户操作栏 \"), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"span\", {\n    onClick: _cache[0] || (_cache[0] = $event => $options.showAuth('user', false))\n  }, \"用户注册\"), _createElementVNode(\"span\", {\n    onClick: _cache[1] || (_cache[1] = $event => $options.showAuth('merchant', false))\n  }, \"商家入驻\"), _createElementVNode(\"span\", {\n    onClick: _cache[2] || (_cache[2] = $event => $options.showAuth('user', true))\n  }, \"登录\")]), _createCommentVNode(\" 搜索栏 \"), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.searchQuery = $event),\n    type: \"text\",\n    placeholder: \"搜索商品...\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.searchQuery]]), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = (...args) => $options.handleSearch && $options.handleSearch(...args))\n  }, \"搜索\")])]), _createCommentVNode(\" 主导航栏 \"), _createElementVNode(\"nav\", _hoisted_5, [_createElementVNode(\"div\", {\n    class: \"nav-item\",\n    onMouseenter: _cache[5] || (_cache[5] = $event => $data.showCategoryDropdown = true),\n    onMouseleave: _cache[6] || (_cache[6] = $event => $data.showCategoryDropdown = false)\n  }, [_cache[12] || (_cache[12] = _createTextVNode(\" 商品分类 \")), $data.showCategoryDropdown ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.categories, category => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: category.id,\n      class: \"dropdown-item\"\n    }, _toDisplayString(category.name), 1 /* TEXT */);\n  }), 128 /* KEYED_FRAGMENT */))])) : _createCommentVNode(\"v-if\", true)], 32 /* NEED_HYDRATION */), _createElementVNode(\"div\", {\n    class: \"nav-item\",\n    onClick: _cache[7] || (_cache[7] = $event => $options.switchTab('orders'))\n  }, \"我的订单\"), _createElementVNode(\"div\", {\n    class: \"nav-item\",\n    onClick: _cache[8] || (_cache[8] = $event => $options.switchTab('profile'))\n  }, \"个人中心\"), _createElementVNode(\"div\", {\n    class: \"nav-item cart\",\n    onClick: _cache[9] || (_cache[9] = $event => $options.switchTab('cart'))\n  }, [_cache[13] || (_cache[13] = _createTextVNode(\" 购物车 \")), $data.cartCount > 0 ? (_openBlock(), _createElementBlock(\"span\", _hoisted_7, _toDisplayString($data.cartCount), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])]), _createCommentVNode(\" 商品列表 \"), _createVNode(_component_ProductList, {\n    products: $options.filteredProducts,\n    onAddToCart: $options.addToCart\n  }, null, 8 /* PROPS */, [\"products\", \"onAddToCart\"]), _createCommentVNode(\" 认证模态框 \"), $data.showAuthModal ? (_openBlock(), _createBlock(_component_AuthModal, {\n    key: 0,\n    authType: $data.currentAuthType,\n    \"onUpdate:authType\": _cache[10] || (_cache[10] = $event => $data.currentAuthType = $event),\n    isLoginView: $data.isLoginView,\n    onClose: _cache[11] || (_cache[11] = $event => $data.showAuthModal = false),\n    onSubmit: $options.handleAuth\n  }, null, 8 /* PROPS */, [\"authType\", \"isLoginView\", \"onSubmit\"])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_hoisted_2","onClick","_cache","$event","$options","showAuth","_hoisted_3","_hoisted_4","$data","searchQuery","type","placeholder","args","handleSearch","_hoisted_5","onMouseenter","showCategoryDropdown","onMouseleave","_hoisted_6","_Fragment","_renderList","categories","category","key","id","name","switchTab","cartCount","_hoisted_7","_toDisplayString","_createVNode","_component_ProductList","products","filteredProducts","onAddToCart","addToCart","showAuthModal","_createBlock","_component_AuthModal","authType","currentAuthType","isLoginView","onClose","onSubmit","handleAuth"],"sources":["D:\\Desktop\\ecomplat\\src\\views\\EcommerceHome.vue"],"sourcesContent":["<template>\r\n    <div class=\"ecommerce-home\">\r\n      <!-- 顶部用户操作栏 -->\r\n      <div class=\"user-actions\">\r\n        <span @click=\"showAuth('user', false)\">用户注册</span>\r\n        <span @click=\"showAuth('merchant', false)\">商家入驻</span>\r\n        <span @click=\"showAuth('user', true)\">登录</span>\r\n      </div>\r\n  \r\n      <!-- 搜索栏 -->\r\n      <div class=\"search-container\">\r\n        <div class=\"search-bar\">\r\n          <input\r\n            v-model=\"searchQuery\"\r\n            type=\"text\"\r\n            placeholder=\"搜索商品...\"\r\n          >\r\n          <button @click=\"handleSearch\">搜索</button>\r\n        </div>\r\n      </div>\r\n  \r\n      <!-- 主导航栏 -->\r\n      <nav class=\"main-nav\">\r\n        <div\r\n          class=\"nav-item\"\r\n          @mouseenter=\"showCategoryDropdown = true\"\r\n          @mouseleave=\"showCategoryDropdown = false\"\r\n        >\r\n          商品分类\r\n          <div v-if=\"showCategoryDropdown\" class=\"dropdown-menu\">\r\n            <div\r\n              v-for=\"category in categories\"\r\n              :key=\"category.id\"\r\n              class=\"dropdown-item\"\r\n            >\r\n              {{ category.name }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"nav-item\" @click=\"switchTab('orders')\">我的订单</div>\r\n        <div class=\"nav-item\" @click=\"switchTab('profile')\">个人中心</div>\r\n        <div class=\"nav-item cart\" @click=\"switchTab('cart')\">\r\n          购物车\r\n          <span v-if=\"cartCount > 0\" class=\"cart-badge\">{{ cartCount }}</span>\r\n        </div>\r\n      </nav>\r\n  \r\n      <!-- 商品列表 -->\r\n      <ProductList :products=\"filteredProducts\" @add-to-cart=\"addToCart\" />\r\n  \r\n      <!-- 认证模态框 -->\r\n      <AuthModal\r\n        v-if=\"showAuthModal\"\r\n        v-model:authType=\"currentAuthType\"\r\n        :isLoginView=\"isLoginView\"\r\n        @close=\"showAuthModal = false\"\r\n        @submit=\"handleAuth\"\r\n      />\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import ProductList from '@/components/ProductList.vue'\r\n  import AuthModal from '@/components/AuthModal.vue'\r\n  import { register, login } from '@/api/auth'\r\n  \r\n  export default {\r\n    name: 'EcommerceHome',\r\n    components: { ProductList, AuthModal },\r\n    data() {\r\n      return {\r\n        searchQuery: '',\r\n        showAuthModal: false,\r\n        currentAuthType: 'user',\r\n        isLoginView: false,\r\n        showCategoryDropdown: false,\r\n        cartCount: 0,\r\n        categories: [\r\n          { id: 1, name: '白酒' },\r\n          { id: 2, name: '红酒' },\r\n          { id: 3, name: '啤酒' },\r\n          { id: 4, name: '洋酒' },\r\n          { id: 5, name: '黄酒' },\r\n          { id: 6, name: '果酒' },\r\n          { id: 7, name: '保健酒' },\r\n          { id: 8, name: '其他酒类' }\r\n        ],\r\n        products: [\r\n          { id: 1, name: '茅台迎宾酒 普迎宾 2013年 酱香型白酒', price: 100 },\r\n          { id: 2, name: '五粮液 52度 浓香型白酒', price: 200 },\r\n          { id: 3, name: '泸州老窖 特曲 52度', price: 150 },\r\n          { id: 4, name: '洋河蓝色经典 梦之蓝', price: 300 }\r\n        ]\r\n      }\r\n    },\r\n    computed: {\r\n      filteredProducts() {\r\n        return this.products.filter(p => p.name.includes(this.searchQuery))\r\n      }\r\n    },\r\n    methods: {\r\n      handleSearch() {\r\n        console.log('搜索:', this.searchQuery)\r\n      },\r\n      switchTab(tab) {\r\n        console.log('切换到:', tab)\r\n      },\r\n      showAuth(type, isLogin) {\r\n        this.currentAuthType = type\r\n        this.isLoginView = isLogin\r\n        this.showAuthModal = true\r\n      },\r\n      async handleAuth(form) {\r\n        try {\r\n        const api = this.isLoginView ? login : register;\r\n        const res = await api({\r\n          username: form.username,\r\n          email: form.email,\r\n          phone: form.phone,\r\n          password: form.password,\r\n          type: form.type\r\n      });\r\n\r\n        if (this.isLoginView) {\r\n          // 登录成功，保存用户 ID 和类型\r\n          localStorage.setItem('uid', res.data.toString());\r\n          console.log(localStorage.getItem('uid')); \r\n          localStorage.setItem('username', form.username);\r\n          localStorage.setItem('userType', this.currentAuthType); // 'user' 或 'merchant'\r\n\r\n          if (this.currentAuthType === 'merchant') {\r\n            localStorage.setItem('merchantName', form.username);\r\n            this.$message.success('商家登录成功');\r\n            this.$router.push('/merchant'); // ✅ 跳转到商家首页\r\n          } else {\r\n            this.$message.success('用户登录成功');\r\n            this.$router.push('/user'); // 或用户首页\r\n          }\r\n        } else {\r\n          this.$message.success('注册成功，请登录');\r\n        }\r\n\r\n        this.showAuthModal = false;\r\n      } catch (err) {\r\n        const msg =\r\n          err?.response?.data?.message ||\r\n          err?.response?.data ||\r\n          '请求失败，请稍后重试';\r\n        alert(typeof msg === 'object' ? JSON.stringify(msg) : msg);\r\n      }\r\n    },\r\n      addToCart(product) {\r\n        this.cartCount++\r\n        console.log('添加到购物车:', product.name)\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .ecommerce-home {\r\n    font-family: 'Arial', sans-serif;\r\n    display: flex;\r\n    flex-direction: column;\r\n    min-height: 100vh;\r\n    position: relative;\r\n  }\r\n  \r\n  /* 用户操作栏 - 左上角 */\r\n  .user-actions {\r\n    position: absolute;\r\n    top: 10px;\r\n    left: 20px;\r\n    display: flex;\r\n    gap: 15px;\r\n    font-size: 14px;\r\n    z-index: 100;\r\n  }\r\n  \r\n  .user-actions span {\r\n    color: #1890ff;\r\n    cursor: pointer;\r\n    transition: color 0.2s;\r\n    padding: 5px;\r\n  }\r\n  \r\n  .user-actions span:hover {\r\n    color: #096dd9;\r\n    text-decoration: underline;\r\n  }\r\n  \r\n  .search-container {\r\n    padding: 1rem 2rem;\r\n    background-color: white;\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n    margin-top: 40px; /* 为顶部用户操作栏留出空间 */\r\n  }\r\n  \r\n  .search-bar {\r\n    display: flex;\r\n    max-width: 800px;\r\n    margin: 0 auto;\r\n  }\r\n  \r\n  .search-bar input {\r\n    flex: 1;\r\n    padding: 0.75rem;\r\n    border: 1px solid #ddd;\r\n    border-radius: 4px 0 0 4px;\r\n    font-size: 1rem;\r\n  }\r\n  \r\n  .search-bar button {\r\n    padding: 0 1.5rem;\r\n    background-color: #1890ff;\r\n    color: white;\r\n    border: none;\r\n    border-radius: 0 4px 4px 0;\r\n    cursor: pointer;\r\n    font-size: 1rem;\r\n  }\r\n  \r\n  /* 均匀分布的主导航栏 */\r\n  .main-nav {\r\n    display: grid;\r\n    grid-template-columns: repeat(4, 1fr);\r\n    padding: 15px 0;\r\n    background-color: #1890ff;\r\n    color: white;\r\n    text-align: center;\r\n  }\r\n  \r\n  .nav-item {\r\n    position: relative;\r\n    padding: 8px 0;\r\n    cursor: pointer;\r\n    font-weight: 500;\r\n    transition: all 0.2s;\r\n  }\r\n  \r\n  .nav-item:hover {\r\n    transform: translateY(-2px);\r\n  }\r\n  \r\n  .dropdown-menu {\r\n    position: absolute;\r\n    top: 100%;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: white;\r\n    border-radius: 4px;\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n    width: 150px;\r\n    z-index: 100;\r\n  }\r\n  \r\n  .dropdown-item {\r\n    padding: 0.75rem 1rem;\r\n    color: #333;\r\n    border-bottom: 1px solid #eee;\r\n  }\r\n  \r\n  .dropdown-item:hover {\r\n    background-color: #f5f5f5;\r\n  }\r\n  \r\n  .cart {\r\n    position: relative;\r\n  }\r\n  \r\n  .cart-badge {\r\n    position: absolute;\r\n    top: -5px;\r\n    right: 10px;\r\n    background-color: #f56c6c;\r\n    color: white;\r\n    border-radius: 50%;\r\n    width: 18px;\r\n    height: 18px;\r\n    font-size: 12px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n  \r\n  .app-footer {\r\n    text-align: center;\r\n    padding: 1rem;\r\n    background-color: #f5f5f5;\r\n    margin-top: auto;\r\n  }\r\n  \r\n  /* 响应式设计 */\r\n  @media (max-width: 768px) {\r\n    .main-nav {\r\n      grid-template-columns: 1fr;\r\n      gap: 10px;\r\n    }\r\n    \r\n    .user-actions {\r\n      position: static;\r\n      justify-content: center;\r\n      margin-bottom: 10px;\r\n      padding: 10px;\r\n      background-color: #f5f5f5;\r\n    }\r\n    \r\n    .search-container {\r\n      margin-top: 0;\r\n    }\r\n  }\r\n  </style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}