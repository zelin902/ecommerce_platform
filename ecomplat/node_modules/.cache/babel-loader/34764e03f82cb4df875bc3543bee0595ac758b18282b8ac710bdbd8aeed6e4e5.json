{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport ProductList from '@/components/ProductList.vue';\nimport AuthModal from '@/components/AuthModal.vue';\nimport { register, login } from '@/api/auth';\nexport default {\n  name: 'EcommerceHome',\n  components: {\n    ProductList,\n    AuthModal\n  },\n  data() {\n    return {\n      searchQuery: '',\n      showAuthModal: false,\n      currentAuthType: 'user',\n      isLoginView: false,\n      showCategoryDropdown: false,\n      cartCount: 0,\n      categories: [{\n        id: 1,\n        name: '白酒'\n      }, {\n        id: 2,\n        name: '红酒'\n      }, {\n        id: 3,\n        name: '啤酒'\n      }, {\n        id: 4,\n        name: '洋酒'\n      }, {\n        id: 5,\n        name: '黄酒'\n      }, {\n        id: 6,\n        name: '果酒'\n      }, {\n        id: 7,\n        name: '保健酒'\n      }, {\n        id: 8,\n        name: '其他酒类'\n      }],\n      products: [{\n        id: 1,\n        name: '茅台迎宾酒 普迎宾 2013年 酱香型白酒',\n        price: 100\n      }, {\n        id: 2,\n        name: '五粮液 52度 浓香型白酒',\n        price: 200\n      }, {\n        id: 3,\n        name: '泸州老窖 特曲 52度',\n        price: 150\n      }, {\n        id: 4,\n        name: '洋河蓝色经典 梦之蓝',\n        price: 300\n      }]\n    };\n  },\n  computed: {\n    filteredProducts() {\n      return this.products.filter(p => p.name.includes(this.searchQuery));\n    }\n  },\n  methods: {\n    handleSearch() {\n      console.log('搜索:', this.searchQuery);\n    },\n    switchTab(tab) {\n      console.log('切换到:', tab);\n    },\n    showAuth(type, isLogin) {\n      this.currentAuthType = type;\n      this.isLoginView = isLogin;\n      this.showAuthModal = true;\n    },\n    async handleAuth(form) {\n      try {\n        const api = this.isLoginView ? login : register;\n        const res = await api({\n          username: form.username,\n          email: form.email,\n          phone: form.phone,\n          password: form.password,\n          type: form.type\n        });\n        if (this.isLoginView) {\n          // 登录成功，保存用户 ID 和类型\n          localStorage.setItem('userId', res.data.id);\n          console.log(localStorage.getItem('userId'));\n          localStorage.setItem('username', form.username);\n          localStorage.setItem('userType', this.currentAuthType); // 'user' 或 'merchant'\n\n          if (this.currentAuthType === 'merchant') {\n            localStorage.setItem('merchantName', form.username);\n            this.$message.success('商家登录成功');\n            this.$router.push('/merchant'); // ✅ 跳转到商家首页\n          } else {\n            this.$message.success('用户登录成功');\n            this.$router.push('/user'); // 或用户首页\n          }\n        } else {\n          this.$message.success('注册成功，请登录');\n        }\n        this.showAuthModal = false;\n      } catch (err) {\n        const msg = err?.response?.data?.message || err?.response?.data || '请求失败，请稍后重试';\n        alert(typeof msg === 'object' ? JSON.stringify(msg) : msg);\n      }\n    },\n    addToCart(product) {\n      this.cartCount++;\n      console.log('添加到购物车:', product.name);\n    }\n  }\n};","map":{"version":3,"names":["ProductList","AuthModal","register","login","name","components","data","searchQuery","showAuthModal","currentAuthType","isLoginView","showCategoryDropdown","cartCount","categories","id","products","price","computed","filteredProducts","filter","p","includes","methods","handleSearch","console","log","switchTab","tab","showAuth","type","isLogin","handleAuth","form","api","res","username","email","phone","password","localStorage","setItem","getItem","$message","success","$router","push","err","msg","response","message","alert","JSON","stringify","addToCart","product"],"sources":["D:\\Desktop\\ecomplat\\src\\views\\EcommerceHome.vue"],"sourcesContent":["<template>\r\n    <div class=\"ecommerce-home\">\r\n      <!-- 顶部用户操作栏 -->\r\n      <div class=\"user-actions\">\r\n        <span @click=\"showAuth('user', false)\">用户注册</span>\r\n        <span @click=\"showAuth('merchant', false)\">商家入驻</span>\r\n        <span @click=\"showAuth('user', true)\">登录</span>\r\n      </div>\r\n  \r\n      <!-- 搜索栏 -->\r\n      <div class=\"search-container\">\r\n        <div class=\"search-bar\">\r\n          <input\r\n            v-model=\"searchQuery\"\r\n            type=\"text\"\r\n            placeholder=\"搜索商品...\"\r\n          >\r\n          <button @click=\"handleSearch\">搜索</button>\r\n        </div>\r\n      </div>\r\n  \r\n      <!-- 主导航栏 -->\r\n      <nav class=\"main-nav\">\r\n        <div\r\n          class=\"nav-item\"\r\n          @mouseenter=\"showCategoryDropdown = true\"\r\n          @mouseleave=\"showCategoryDropdown = false\"\r\n        >\r\n          商品分类\r\n          <div v-if=\"showCategoryDropdown\" class=\"dropdown-menu\">\r\n            <div\r\n              v-for=\"category in categories\"\r\n              :key=\"category.id\"\r\n              class=\"dropdown-item\"\r\n            >\r\n              {{ category.name }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"nav-item\" @click=\"switchTab('orders')\">我的订单</div>\r\n        <div class=\"nav-item\" @click=\"switchTab('profile')\">个人中心</div>\r\n        <div class=\"nav-item cart\" @click=\"switchTab('cart')\">\r\n          购物车\r\n          <span v-if=\"cartCount > 0\" class=\"cart-badge\">{{ cartCount }}</span>\r\n        </div>\r\n      </nav>\r\n  \r\n      <!-- 商品列表 -->\r\n      <ProductList :products=\"filteredProducts\" @add-to-cart=\"addToCart\" />\r\n  \r\n      <!-- 认证模态框 -->\r\n      <AuthModal\r\n        v-if=\"showAuthModal\"\r\n        v-model:authType=\"currentAuthType\"\r\n        :isLoginView=\"isLoginView\"\r\n        @close=\"showAuthModal = false\"\r\n        @submit=\"handleAuth\"\r\n      />\r\n    </div>\r\n  </template>\r\n  \r\n  <script>\r\n  import ProductList from '@/components/ProductList.vue'\r\n  import AuthModal from '@/components/AuthModal.vue'\r\n  import { register, login } from '@/api/auth'\r\n  \r\n  export default {\r\n    name: 'EcommerceHome',\r\n    components: { ProductList, AuthModal },\r\n    data() {\r\n      return {\r\n        searchQuery: '',\r\n        showAuthModal: false,\r\n        currentAuthType: 'user',\r\n        isLoginView: false,\r\n        showCategoryDropdown: false,\r\n        cartCount: 0,\r\n        categories: [\r\n          { id: 1, name: '白酒' },\r\n          { id: 2, name: '红酒' },\r\n          { id: 3, name: '啤酒' },\r\n          { id: 4, name: '洋酒' },\r\n          { id: 5, name: '黄酒' },\r\n          { id: 6, name: '果酒' },\r\n          { id: 7, name: '保健酒' },\r\n          { id: 8, name: '其他酒类' }\r\n        ],\r\n        products: [\r\n          { id: 1, name: '茅台迎宾酒 普迎宾 2013年 酱香型白酒', price: 100 },\r\n          { id: 2, name: '五粮液 52度 浓香型白酒', price: 200 },\r\n          { id: 3, name: '泸州老窖 特曲 52度', price: 150 },\r\n          { id: 4, name: '洋河蓝色经典 梦之蓝', price: 300 }\r\n        ]\r\n      }\r\n    },\r\n    computed: {\r\n      filteredProducts() {\r\n        return this.products.filter(p => p.name.includes(this.searchQuery))\r\n      }\r\n    },\r\n    methods: {\r\n      handleSearch() {\r\n        console.log('搜索:', this.searchQuery)\r\n      },\r\n      switchTab(tab) {\r\n        console.log('切换到:', tab)\r\n      },\r\n      showAuth(type, isLogin) {\r\n        this.currentAuthType = type\r\n        this.isLoginView = isLogin\r\n        this.showAuthModal = true\r\n      },\r\n      async handleAuth(form) {\r\n        try {\r\n        const api = this.isLoginView ? login : register;\r\n        const res = await api({\r\n          username: form.username,\r\n          email: form.email,\r\n          phone: form.phone,\r\n          password: form.password,\r\n          type: form.type\r\n      });\r\n\r\n        if (this.isLoginView) {\r\n          // 登录成功，保存用户 ID 和类型\r\n          localStorage.setItem('userId', res.data.id);\r\n          console.log(localStorage.getItem('userId'));\r\n          localStorage.setItem('username', form.username);\r\n          localStorage.setItem('userType', this.currentAuthType); // 'user' 或 'merchant'\r\n\r\n          if (this.currentAuthType === 'merchant') {\r\n            localStorage.setItem('merchantName', form.username);\r\n            this.$message.success('商家登录成功');\r\n            this.$router.push('/merchant'); // ✅ 跳转到商家首页\r\n          } else {\r\n            this.$message.success('用户登录成功');\r\n            this.$router.push('/user'); // 或用户首页\r\n          }\r\n        } else {\r\n          this.$message.success('注册成功，请登录');\r\n        }\r\n\r\n        this.showAuthModal = false;\r\n      } catch (err) {\r\n        const msg =\r\n          err?.response?.data?.message ||\r\n          err?.response?.data ||\r\n          '请求失败，请稍后重试';\r\n        alert(typeof msg === 'object' ? JSON.stringify(msg) : msg);\r\n      }\r\n    },\r\n      addToCart(product) {\r\n        this.cartCount++\r\n        console.log('添加到购物车:', product.name)\r\n      }\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .ecommerce-home {\r\n    font-family: 'Arial', sans-serif;\r\n    display: flex;\r\n    flex-direction: column;\r\n    min-height: 100vh;\r\n    position: relative;\r\n  }\r\n  \r\n  /* 用户操作栏 - 左上角 */\r\n  .user-actions {\r\n    position: absolute;\r\n    top: 10px;\r\n    left: 20px;\r\n    display: flex;\r\n    gap: 15px;\r\n    font-size: 14px;\r\n    z-index: 100;\r\n  }\r\n  \r\n  .user-actions span {\r\n    color: #1890ff;\r\n    cursor: pointer;\r\n    transition: color 0.2s;\r\n    padding: 5px;\r\n  }\r\n  \r\n  .user-actions span:hover {\r\n    color: #096dd9;\r\n    text-decoration: underline;\r\n  }\r\n  \r\n  .search-container {\r\n    padding: 1rem 2rem;\r\n    background-color: white;\r\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n    margin-top: 40px; /* 为顶部用户操作栏留出空间 */\r\n  }\r\n  \r\n  .search-bar {\r\n    display: flex;\r\n    max-width: 800px;\r\n    margin: 0 auto;\r\n  }\r\n  \r\n  .search-bar input {\r\n    flex: 1;\r\n    padding: 0.75rem;\r\n    border: 1px solid #ddd;\r\n    border-radius: 4px 0 0 4px;\r\n    font-size: 1rem;\r\n  }\r\n  \r\n  .search-bar button {\r\n    padding: 0 1.5rem;\r\n    background-color: #1890ff;\r\n    color: white;\r\n    border: none;\r\n    border-radius: 0 4px 4px 0;\r\n    cursor: pointer;\r\n    font-size: 1rem;\r\n  }\r\n  \r\n  /* 均匀分布的主导航栏 */\r\n  .main-nav {\r\n    display: grid;\r\n    grid-template-columns: repeat(4, 1fr);\r\n    padding: 15px 0;\r\n    background-color: #1890ff;\r\n    color: white;\r\n    text-align: center;\r\n  }\r\n  \r\n  .nav-item {\r\n    position: relative;\r\n    padding: 8px 0;\r\n    cursor: pointer;\r\n    font-weight: 500;\r\n    transition: all 0.2s;\r\n  }\r\n  \r\n  .nav-item:hover {\r\n    transform: translateY(-2px);\r\n  }\r\n  \r\n  .dropdown-menu {\r\n    position: absolute;\r\n    top: 100%;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n    background-color: white;\r\n    border-radius: 4px;\r\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\r\n    width: 150px;\r\n    z-index: 100;\r\n  }\r\n  \r\n  .dropdown-item {\r\n    padding: 0.75rem 1rem;\r\n    color: #333;\r\n    border-bottom: 1px solid #eee;\r\n  }\r\n  \r\n  .dropdown-item:hover {\r\n    background-color: #f5f5f5;\r\n  }\r\n  \r\n  .cart {\r\n    position: relative;\r\n  }\r\n  \r\n  .cart-badge {\r\n    position: absolute;\r\n    top: -5px;\r\n    right: 10px;\r\n    background-color: #f56c6c;\r\n    color: white;\r\n    border-radius: 50%;\r\n    width: 18px;\r\n    height: 18px;\r\n    font-size: 12px;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n  \r\n  .app-footer {\r\n    text-align: center;\r\n    padding: 1rem;\r\n    background-color: #f5f5f5;\r\n    margin-top: auto;\r\n  }\r\n  \r\n  /* 响应式设计 */\r\n  @media (max-width: 768px) {\r\n    .main-nav {\r\n      grid-template-columns: 1fr;\r\n      gap: 10px;\r\n    }\r\n    \r\n    .user-actions {\r\n      position: static;\r\n      justify-content: center;\r\n      margin-bottom: 10px;\r\n      padding: 10px;\r\n      background-color: #f5f5f5;\r\n    }\r\n    \r\n    .search-container {\r\n      margin-top: 0;\r\n    }\r\n  }\r\n  </style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}