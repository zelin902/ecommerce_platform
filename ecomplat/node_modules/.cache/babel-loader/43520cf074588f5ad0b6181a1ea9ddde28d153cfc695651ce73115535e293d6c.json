{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"profile-wrap\"\n};\nconst _hoisted_2 = {\n  class: \"header\"\n};\nconst _hoisted_3 = {\n  class: \"default-tip\"\n};\nconst _hoisted_4 = {\n  class: \"address-list\"\n};\nconst _hoisted_5 = {\n  class: \"info\"\n};\nconst _hoisted_6 = {\n  class: \"tag\"\n};\nconst _hoisted_7 = {\n  class: \"actions\"\n};\nconst _hoisted_8 = [\"onClick\"];\nconst _hoisted_9 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 顶部栏 \"), _createElementVNode(\"header\", _hoisted_2, [_createElementVNode(\"span\", {\n    onClick: _cache[0] || (_cache[0] = $event => _ctx.$router.back()),\n    class: \"back\"\n  }, \"← 返回首页\"), _cache[2] || (_cache[2] = _createElementVNode(\"h2\", null, \"个人中心\", -1 /* CACHED */))]), _createCommentVNode(\" 当前默认地址提示 \"), _createElementVNode(\"section\", _hoisted_3, \" 当前默认地址：\" + _toDisplayString($setup.defaultAddress?.name || '暂无'), 1 /* TEXT */), _createCommentVNode(\" 地址列表 \"), _createElementVNode(\"ul\", _hoisted_4, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.addressList, addr => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: addr.id,\n      class: \"address-card\"\n    }, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"p\", null, [_createElementVNode(\"strong\", null, _toDisplayString(addr.receiver), 1 /* TEXT */), _createTextVNode(\" \" + _toDisplayString(addr.phone), 1 /* TEXT */)]), _createElementVNode(\"p\", null, _toDisplayString(addr.detail), 1 /* TEXT */), _createElementVNode(\"p\", _hoisted_6, _toDisplayString(addr.name), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"button\", {\n      class: \"default-btn\",\n      onClick: $event => $setup.setDefault(addr.id)\n    }, _toDisplayString(addr.isDefault ? '已默认' : '设为默认'), 9 /* TEXT, PROPS */, _hoisted_8), _createElementVNode(\"button\", {\n      class: \"del-btn\",\n      onClick: $event => $setup.delAddress(addr.id)\n    }, \"删除\", 8 /* PROPS */, _hoisted_9)])]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createCommentVNode(\" 新建 / 编辑弹窗 \"), $setup.showModal ? (_openBlock(), _createBlock($setup[\"AddressModal\"], {\n    key: 0,\n    editing: $setup.editingAddress,\n    onClose: _cache[1] || (_cache[1] = $event => $setup.showModal = false),\n    onSave: $setup.saveAddress\n  }, null, 8 /* PROPS */, [\"editing\"])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 底部按钮 \"), _createElementVNode(\"footer\", {\n    class: \"add-footer\"\n  }, [_createElementVNode(\"button\", {\n    class: \"add-btn\",\n    onClick: $setup.openAdd\n  }, \"新建地址\")])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_hoisted_2","onClick","_cache","$event","_ctx","$router","back","_hoisted_3","_toDisplayString","$setup","defaultAddress","name","_hoisted_4","_Fragment","_renderList","addressList","addr","key","id","_hoisted_5","receiver","phone","detail","_hoisted_6","_hoisted_7","setDefault","isDefault","_hoisted_8","delAddress","_hoisted_9","showModal","_createBlock","editing","editingAddress","onClose","onSave","saveAddress","openAdd"],"sources":["D:\\Desktop\\ecomplat\\src\\views\\UserProfile.vue"],"sourcesContent":["<template>\r\n    <div class=\"profile-wrap\">\r\n      <!-- 顶部栏 -->\r\n      <header class=\"header\">\r\n        <span @click=\"$router.back()\" class=\"back\">← 返回首页</span>\r\n        <h2>个人中心</h2>\r\n      </header>\r\n  \r\n      <!-- 当前默认地址提示 -->\r\n      <section class=\"default-tip\">\r\n        当前默认地址：{{ defaultAddress?.name || '暂无' }}\r\n      </section>\r\n  \r\n      <!-- 地址列表 -->\r\n      <ul class=\"address-list\">\r\n        <li v-for=\"addr in addressList\" :key=\"addr.id\" class=\"address-card\">\r\n          <div class=\"info\">\r\n            <p><strong>{{ addr.receiver }}</strong> {{ addr.phone }}</p>\r\n            <p>{{ addr.detail }}</p>\r\n            <p class=\"tag\">{{ addr.name }}</p>\r\n          </div>\r\n          <div class=\"actions\">\r\n            <button class=\"default-btn\" @click=\"setDefault(addr.id)\">\r\n              {{ addr.isDefault ? '已默认' : '设为默认' }}\r\n            </button>\r\n            <button class=\"del-btn\" @click=\"delAddress(addr.id)\">删除</button>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n  \r\n      <!-- 新建 / 编辑弹窗 -->\r\n      <AddressModal\r\n        v-if=\"showModal\"\r\n        :editing=\"editingAddress\"\r\n        @close=\"showModal=false\"\r\n        @save=\"saveAddress\"\r\n      />\r\n  \r\n      <!-- 底部按钮 -->\r\n      <footer class=\"add-footer\">\r\n        <button class=\"add-btn\" @click=\"openAdd\">新建地址</button>\r\n      </footer>\r\n    </div>\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { ref, onMounted } from 'vue'\r\n  import AddressModal from '@/components/AddressModal.vue'\r\n  import { ElMessage } from 'element-plus'\r\n  defineOptions({ name: 'UserProfile' })\r\n  \r\n  const addressList = ref([])\r\n  const defaultAddress = ref(null)\r\n  const showModal = ref(false)\r\n  const editingAddress = ref(null)\r\n  \r\n  // 拉取地址\r\n  async function loadAddress () {\r\n    try {\r\n      const res = await fetch('http://localhost:8081/api/address', { credentials: 'include' })\r\n      const list = await res.json()\r\n      addressList.value = list\r\n      defaultAddress.value = list.find(i => i.isDefault) || null\r\n    } catch (e) {\r\n      ElMessage.error('加载地址失败')\r\n    }\r\n  }\r\n  \r\n  // 设为默认\r\n  async function setDefault (id) {\r\n    await fetch(`http://localhost:8081/api/address/default/${id}`, { method: 'POST', credentials: 'include' })\r\n    ElMessage.success('已设为默认')\r\n    loadAddress()\r\n  }\r\n  \r\n  // 删除\r\n  async function delAddress (id) {\r\n    await fetch(`http://localhost:8081/api/address/${id}`, { method: 'DELETE', credentials: 'include' })\r\n    ElMessage.success('已删除')\r\n    loadAddress()\r\n  }\r\n  \r\n  // 打开新建\r\n  function openAdd () {\r\n    editingAddress.value = null\r\n    showModal.value = true\r\n  }\r\n  \r\n  // 保存（新增或更新）\r\n  async function saveAddress (form) {\r\n    const method = form.id ? 'PUT' : 'POST'\r\n    await fetch('http://localhost:8081/api/address', {\r\n      method,\r\n      headers: { 'Content-Type': 'application/json' },\r\n      credentials: 'include',\r\n      body: JSON.stringify(form)\r\n    })\r\n    ElMessage.success('保存成功')\r\n    showModal.value = false\r\n    loadAddress()\r\n  }\r\n  \r\n  onMounted(loadAddress)\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .profile-wrap { min-height: 100vh; background: #f6f6f6; }\r\n  .header {\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 12px;\r\n    background: #fff;\r\n    border-bottom: 1px solid #eee;\r\n  }\r\n  .back { margin-right: 12px; font-size: 16px; color: #1890ff; cursor: pointer; }\r\n  .default-tip { padding: 10px 15px; font-size: 14px; color: #666; }\r\n  .address-list { padding: 0 15px 70px; }\r\n  .address-card {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n    background: #fff;\r\n    margin-bottom: 10px;\r\n    padding: 12px;\r\n    border-radius: 6px;\r\n  }\r\n  .address-card .info p { margin: 4px 0; font-size: 14px; }\r\n  .actions button {\r\n    margin-left: 8px;\r\n    padding: 4px 8px;\r\n    border: none;\r\n    border-radius: 4px;\r\n    font-size: 12px;\r\n    cursor: pointer;\r\n  }\r\n  .default-btn { background: #1890ff; color: #fff; }\r\n  .del-btn { background: #ff4d4f; color: #fff; }\r\n  .add-footer {\r\n    position: fixed;\r\n    bottom: 0;\r\n    width: 100%;\r\n    padding: 10px;\r\n    background: #fff;\r\n  }\r\n  .add-btn {\r\n    width: 100%;\r\n    padding: 12px;\r\n    border: none;\r\n    border-radius: 4px;\r\n    background: #ff5000;\r\n    color: #fff;\r\n    font-size: 16px;\r\n    cursor: pointer;\r\n  }\r\n  </style>"],"mappings":";;EACSA,KAAK,EAAC;AAAc;;EAEfA,KAAK,EAAC;AAAQ;;EAMbA,KAAK,EAAC;AAAa;;EAKxBA,KAAK,EAAC;AAAc;;EAEfA,KAAK,EAAC;AAAM;;EAGZA,KAAK,EAAC;AAAK;;EAEXA,KAAK,EAAC;AAAS;;;;uBApB1BC,mBAAA,CAyCM,OAzCNC,UAyCM,GAxCJC,mBAAA,SAAY,EACZC,mBAAA,CAGS,UAHTC,UAGS,GAFPD,mBAAA,CAAwD;IAAjDE,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,IAAA,CAAAC,OAAO,CAACC,IAAI;IAAIX,KAAK,EAAC;KAAO,QAAM,G,0BACjDI,mBAAA,CAAa,YAAT,MAAI,oB,GAGVD,mBAAA,cAAiB,EACjBC,mBAAA,CAEU,WAFVQ,UAEU,EAFmB,UACpB,GAAAC,gBAAA,CAAGC,MAAA,CAAAC,cAAc,EAAEC,IAAI,0BAGhCb,mBAAA,UAAa,EACbC,mBAAA,CAcK,MAdLa,UAcK,I,kBAbHhB,mBAAA,CAYKiB,SAAA,QAAAC,WAAA,CAZcL,MAAA,CAAAM,WAAW,EAAnBC,IAAI;yBAAfpB,mBAAA,CAYK;MAZ4BqB,GAAG,EAAED,IAAI,CAACE,EAAE;MAAEvB,KAAK,EAAC;QACnDI,mBAAA,CAIM,OAJNoB,UAIM,GAHJpB,mBAAA,CAA4D,YAAzDA,mBAAA,CAAoC,gBAAAS,gBAAA,CAAzBQ,IAAI,CAACI,QAAQ,kB,iBAAY,GAAC,GAAAZ,gBAAA,CAAGQ,IAAI,CAACK,KAAK,iB,GACrDtB,mBAAA,CAAwB,WAAAS,gBAAA,CAAlBQ,IAAI,CAACM,MAAM,kBACjBvB,mBAAA,CAAkC,KAAlCwB,UAAkC,EAAAf,gBAAA,CAAhBQ,IAAI,CAACL,IAAI,iB,GAE7BZ,mBAAA,CAKM,OALNyB,UAKM,GAJJzB,mBAAA,CAES;MAFDJ,KAAK,EAAC,aAAa;MAAEM,OAAK,EAAAE,MAAA,IAAEM,MAAA,CAAAgB,UAAU,CAACT,IAAI,CAACE,EAAE;wBACjDF,IAAI,CAACU,SAAS,yCAAAC,UAAA,GAEnB5B,mBAAA,CAAgE;MAAxDJ,KAAK,EAAC,SAAS;MAAEM,OAAK,EAAAE,MAAA,IAAEM,MAAA,CAAAmB,UAAU,CAACZ,IAAI,CAACE,EAAE;OAAG,IAAE,iBAAAW,UAAA,E;oCAK7D/B,mBAAA,eAAkB,EAEVW,MAAA,CAAAqB,SAAS,I,cADjBC,YAAA,CAKEtB,MAAA;;IAHCuB,OAAO,EAAEvB,MAAA,CAAAwB,cAAc;IACvBC,OAAK,EAAAhC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEM,MAAA,CAAAqB,SAAS;IAChBK,MAAI,EAAE1B,MAAA,CAAA2B;6EAGTtC,mBAAA,UAAa,EACbC,mBAAA,CAES;IAFDJ,KAAK,EAAC;EAAY,IACxBI,mBAAA,CAAsD;IAA9CJ,KAAK,EAAC,SAAS;IAAEM,OAAK,EAAEQ,MAAA,CAAA4B;KAAS,MAAI,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}